{"ast":null,"code":"import stringSimilarity from \"string-similarity\";\nimport { FixedStats } from \"../Datas/Stats\";\nexport function OcrRetouch({\n  text,\n  lang\n}) {\n  if (!text || !Array.isArray(text)) {\n    console.log(startIndex);\n    return {\n      retType: [],\n      retValue: []\n    };\n  }\n  ;\n  if (!lang) lang = \"en\";\n  const statList = FixedStats.map(stat => stat[lang]).filter(Boolean);\n  let startIndex = -1;\n  for (let i = 0; i < text.length; i++) {\n    const {\n      bestMatch\n    } = stringSimilarity.findBestMatch(text[i], statList);\n    if (bestMatch.rating > 0.8) {\n      startIndex = i;\n      break;\n    }\n  }\n  console.log(startIndex);\n  if (startIndex === -1 || startIndex + 13 >= text.length) {\n    return {\n      retType: [],\n      retValue: []\n    };\n  }\n  const retType = [];\n  const retValue = [];\n  for (let i = 0; i < 14; i += 2) {\n    const key = text[startIndex + i];\n    const val = text[startIndex + i + 1];\n    const {\n      bestMatch\n    } = stringSimilarity.findBestMatch(key, statList);\n    const matched = bestMatch.rating > 0.8 ? bestMatch.target : null;\n    if (matched) {\n      retType.push(matched);\n      retValue.push(val);\n    }\n  }\n  console.log({\n    retType,\n    retValue\n  });\n  return {\n    retType,\n    retValue\n  };\n}\n_c = OcrRetouch;\nvar _c;\n$RefreshReg$(_c, \"OcrRetouch\");","map":{"version":3,"names":["stringSimilarity","FixedStats","OcrRetouch","text","lang","Array","isArray","console","log","startIndex","retType","retValue","statList","map","stat","filter","Boolean","i","length","bestMatch","findBestMatch","rating","key","val","matched","target","push","_c","$RefreshReg$"],"sources":["d:/project/_CodeFiles/wuthering/frontend/src/func/OcrRetouch.js"],"sourcesContent":["import stringSimilarity from \"string-similarity\";\r\nimport { FixedStats } from \"../Datas/Stats\";\r\n\r\nexport function OcrRetouch({ text, lang }) {\r\n  if (!text || !Array.isArray(text)){ console.log(startIndex); return { retType: [], retValue: [] }};\r\n  if (!lang) lang = \"en\";\r\n\r\n  const statList = FixedStats.map(stat => stat[lang]).filter(Boolean);\r\n\r\n  let startIndex = -1;\r\n\r\n  for (let i = 0; i < text.length; i++) {\r\n    const { bestMatch } = stringSimilarity.findBestMatch(text[i], statList);\r\n    if (bestMatch.rating > 0.8) {\r\n      startIndex = i;\r\n      break;\r\n    }\r\n  }\r\n\r\n  console.log(startIndex);\r\n\r\n  if (startIndex === -1 || startIndex + 13 >= text.length) {\r\n    return { retType: [], retValue: [] };\r\n  }\r\n\r\n  const retType = [];\r\n  const retValue = [];\r\n\r\n  for (let i = 0; i < 14; i += 2) {\r\n    const key = text[startIndex + i];\r\n    const val = text[startIndex + i + 1];\r\n\r\n    const { bestMatch } = stringSimilarity.findBestMatch(key, statList);\r\n    const matched = bestMatch.rating > 0.8 ? bestMatch.target : null;\r\n\r\n    if (matched) {\r\n      retType.push(matched);\r\n      retValue.push(val);\r\n    }\r\n  }\r\n\r\n  console.log({ retType, retValue })\r\n  return { retType, retValue };\r\n}\r\n"],"mappings":"AAAA,OAAOA,gBAAgB,MAAM,mBAAmB;AAChD,SAASC,UAAU,QAAQ,gBAAgB;AAE3C,OAAO,SAASC,UAAUA,CAAC;EAAEC,IAAI;EAAEC;AAAK,CAAC,EAAE;EACzC,IAAI,CAACD,IAAI,IAAI,CAACE,KAAK,CAACC,OAAO,CAACH,IAAI,CAAC,EAAC;IAAEI,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;IAAE,OAAO;MAAEC,OAAO,EAAE,EAAE;MAAEC,QAAQ,EAAE;IAAG,CAAC;EAAA;EAAC;EAClG,IAAI,CAACP,IAAI,EAAEA,IAAI,GAAG,IAAI;EAEtB,MAAMQ,QAAQ,GAAGX,UAAU,CAACY,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACV,IAAI,CAAC,CAAC,CAACW,MAAM,CAACC,OAAO,CAAC;EAEnE,IAAIP,UAAU,GAAG,CAAC,CAAC;EAEnB,KAAK,IAAIQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGd,IAAI,CAACe,MAAM,EAAED,CAAC,EAAE,EAAE;IACpC,MAAM;MAAEE;IAAU,CAAC,GAAGnB,gBAAgB,CAACoB,aAAa,CAACjB,IAAI,CAACc,CAAC,CAAC,EAAEL,QAAQ,CAAC;IACvE,IAAIO,SAAS,CAACE,MAAM,GAAG,GAAG,EAAE;MAC1BZ,UAAU,GAAGQ,CAAC;MACd;IACF;EACF;EAEAV,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;EAEvB,IAAIA,UAAU,KAAK,CAAC,CAAC,IAAIA,UAAU,GAAG,EAAE,IAAIN,IAAI,CAACe,MAAM,EAAE;IACvD,OAAO;MAAER,OAAO,EAAE,EAAE;MAAEC,QAAQ,EAAE;IAAG,CAAC;EACtC;EAEA,MAAMD,OAAO,GAAG,EAAE;EAClB,MAAMC,QAAQ,GAAG,EAAE;EAEnB,KAAK,IAAIM,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,EAAE,EAAEA,CAAC,IAAI,CAAC,EAAE;IAC9B,MAAMK,GAAG,GAAGnB,IAAI,CAACM,UAAU,GAAGQ,CAAC,CAAC;IAChC,MAAMM,GAAG,GAAGpB,IAAI,CAACM,UAAU,GAAGQ,CAAC,GAAG,CAAC,CAAC;IAEpC,MAAM;MAAEE;IAAU,CAAC,GAAGnB,gBAAgB,CAACoB,aAAa,CAACE,GAAG,EAAEV,QAAQ,CAAC;IACnE,MAAMY,OAAO,GAAGL,SAAS,CAACE,MAAM,GAAG,GAAG,GAAGF,SAAS,CAACM,MAAM,GAAG,IAAI;IAEhE,IAAID,OAAO,EAAE;MACXd,OAAO,CAACgB,IAAI,CAACF,OAAO,CAAC;MACrBb,QAAQ,CAACe,IAAI,CAACH,GAAG,CAAC;IACpB;EACF;EAEAhB,OAAO,CAACC,GAAG,CAAC;IAAEE,OAAO;IAAEC;EAAS,CAAC,CAAC;EAClC,OAAO;IAAED,OAAO;IAAEC;EAAS,CAAC;AAC9B;AAACgB,EAAA,GAxCezB,UAAU;AAAA,IAAAyB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}